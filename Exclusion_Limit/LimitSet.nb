(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      7288,        173]
NotebookOptionsPosition[      6561,        151]
NotebookOutlinePosition[      6985,        168]
CellTagsIndexPosition[      6942,        165]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
                                                         Hamzeh Khanpour \
\>", "Section",
 CellChangeTimes->{{3.947504970392078*^9, 3.9475050119796677`*^9}},
 Background->RGBColor[
  1, 0.925, 0.925],ExpressionUUID->"3f6da65c-7622-4070-8da9-9350fb19ac36"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Pdist", "[", 
    RowBox[{"n_", ",", "S_", ",", "B_"}], "]"}], ":=", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{"S", "+", "B"}], ")"}], "^", "n"}], 
     RowBox[{"Factorial", "[", "n", "]"}]], 
    RowBox[{"Exp", "[", 
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{"S", "+", "B"}], ")"}]}], "]"}]}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Bayesian", " ", "approach"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "\[Sigma]CL", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]CL", "[", 
   RowBox[{"CL_", ",", "\[Epsilon]sig_", ",", "L_", ",", "B_"}], "]"}], ":=", 
  
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "n", ",", "den", ",", "num", ",", "\[Sigma]CLex", ",", "\[Sigma]CLi"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", "=", 
      RowBox[{"Round", "[", "B", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"den", "=", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{"Pdist", "[", 
         RowBox[{"n", ",", 
          RowBox[{"\[Sigma]sig", " ", "\[Epsilon]sig", " ", "L"}], ",", "B"}],
          "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Sigma]sig", ",", "0", ",", "\[Infinity]"}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"num", "=", 
      RowBox[{"Integrate", "[", 
       RowBox[{
        RowBox[{"Pdist", "[", 
         RowBox[{"n", ",", 
          RowBox[{"\[Sigma]sig", " ", "\[Epsilon]sig", " ", "L"}], ",", "B"}],
          "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Sigma]sig", ",", "0", ",", "\[Sigma]CLi"}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Sigma]CLex", "=", 
      RowBox[{"\[Sigma]CLi", "/.", 
       RowBox[{"FindRoot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"CL", " ", "den"}], "\[Equal]", "num"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Sigma]CLi", ",", "0"}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "\[Sigma]CLex", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.684557951810173*^9, 3.684557962395752*^9}, {
   3.6845594385236673`*^9, 3.68455943908255*^9}, {3.68456002843104*^9, 
   3.684560038294429*^9}, 3.68456050884723*^9, {3.684560706308737*^9, 
   3.684560738532812*^9}, {3.684560788857616*^9, 3.684560799288282*^9}, {
   3.6845608299001837`*^9, 3.6845608315150547`*^9}, {3.684560864639658*^9, 
   3.684560911560554*^9}, {3.684560999648402*^9, 3.684561011854912*^9}, {
   3.6845611667625427`*^9, 3.684561168441422*^9}, {3.684563976217615*^9, 
   3.684564015609344*^9}, {3.684565793977851*^9, 3.684565795231923*^9}, {
   3.684565908967066*^9, 3.684565910469125*^9}, {3.684565959445488*^9, 
   3.684565959749772*^9}, {3.684566312711783*^9, 3.684566317187737*^9}, {
   3.684590738298832*^9, 3.684590785867568*^9}, {3.684591026793342*^9, 
   3.684591030633326*^9}, {3.6845912168866*^9, 3.684591258143837*^9}, {
   3.684592544344965*^9, 3.6845925468219357`*^9}, {3.684594041300973*^9, 
   3.6845941622428017`*^9}, {3.684594848642222*^9, 3.684594850351235*^9}, {
   3.703474886914365*^9, 3.7034748962168922`*^9}, 3.703490928889988*^9, {
   3.703490963568864*^9, 3.703490965046101*^9}, {3.94750492806996*^9, 
   3.947504967595903*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"52c8801f-189c-46aa-b616-e9c2ea80e9fd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Sigma]CL", "[", 
   RowBox[{"0.95", ",", "0.145179", ",", "300", ",", "114.865513273"}], "]"}],
   "  "}]], "Input",
 CellChangeTimes->{{3.703474908705236*^9, 3.70347492387671*^9}, {
   3.7034754287093067`*^9, 3.703475471926262*^9}, {3.703475923328382*^9, 
   3.70347593270159*^9}, {3.703475994178451*^9, 3.703476002120306*^9}, {
   3.7034886809841623`*^9, 3.7034887192046957`*^9}, {3.703489028964943*^9, 
   3.703489039199066*^9}, {3.703489318233245*^9, 3.703489326127748*^9}, 
   3.703490875244197*^9, {3.703491003273568*^9, 3.70349101646544*^9}, {
   3.7035082041538897`*^9, 3.7035082086601467`*^9}, {3.7035082396120124`*^9, 
   3.703508241766059*^9}, 3.7035096289393854`*^9, 3.7039251631738796`*^9, {
   3.703925214128186*^9, 3.703925214880781*^9}, {3.703925363955488*^9, 
   3.703925374033208*^9}, {3.7040330650308323`*^9, 3.7040331062355022`*^9}, {
   3.7040334237236223`*^9, 3.704033427048793*^9}, {3.7040336602399693`*^9, 
   3.704033696186487*^9}, {3.7040340891753607`*^9, 3.704034092690859*^9}, {
   3.704034515399104*^9, 3.7040345202764378`*^9}, {3.704034703101362*^9, 
   3.704034719644113*^9}, {3.704034893580339*^9, 3.704034896401361*^9}, {
   3.7040350043702097`*^9, 3.704035007196679*^9}, 3.704036160501007*^9, {
   3.704189447411313*^9, 3.704189452130204*^9}, 3.7041895017512627`*^9, {
   3.9475048903581142`*^9, 3.9475048905824614`*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"a848d322-cbcb-4f50-843a-c75828b57d5d"],

Cell[BoxData["0.5251979928726123`"], "Output",
 CellChangeTimes->{3.7034749273968143`*^9, 3.703475587881867*^9, 
  3.703476112708396*^9, 3.7034888356488867`*^9, 3.703489155094265*^9, 
  3.703489444905095*^9, 3.703490993165077*^9, 3.7034911349563026`*^9, 
  3.703508243524373*^9, 3.7035083622476487`*^9, 3.7035085632123365`*^9, 
  3.703925344828413*^9, 3.7040331271643*^9, 3.704033431238577*^9, 
  3.704033719028089*^9, 3.704034096360805*^9, 3.7040345304859962`*^9, 
  3.7040347333955*^9, 3.70403490054366*^9, 3.7040350190866737`*^9, 
  3.704036171430975*^9, 3.7041895129280157`*^9, 3.947504946410124*^9, 
  3.947505026603673*^9},
 CellLabel->"Out[8]=",ExpressionUUID->"22c5507f-a681-4ee7-8ab2-97b6332546b2"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1920, 1146},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>1.8 Inherited,
FrontEndVersion->"13.2 for Linux x86 (64-bit) (November 18, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"96a4ff08-4635-48ce-a185-c110a1426914"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 266, 5, 128, "Section",ExpressionUUID->"3f6da65c-7622-4070-8da9-9350fb19ac36"],
Cell[849, 29, 3479, 80, 483, "Input",ExpressionUUID->"52c8801f-189c-46aa-b616-e9c2ea80e9fd"],
Cell[CellGroupData[{
Cell[4353, 113, 1470, 22, 56, "Input",ExpressionUUID->"a848d322-cbcb-4f50-843a-c75828b57d5d"],
Cell[5826, 137, 707, 10, 60, "Output",ExpressionUUID->"22c5507f-a681-4ee7-8ab2-97b6332546b2"]
}, Open  ]]
}, Open  ]]
}
]
*)

